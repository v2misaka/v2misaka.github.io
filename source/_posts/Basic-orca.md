---
title: Basics of Orca
date: 2023-11-15 15:08:32
mathjax: true
categories: 
- Tutorials
- Orca
---
This post is for some basic use of **Orca**ã€‚

<!-- more -->
# Input file

## How to generate an input file

Orca only use one input file: `filename.inp`, which is an ASCII encoded file.

### For Linux

Just simply create `filename.inp`. And make sure the **End of line Sequence** is `LF`.

### For Windows

Orca input file can be generated by **Avogadro** program in Windows, which can be downloaded it from [Orca Forum](https://orcaforum.kofo.mpg.de/app.php/portal).

If you want to generate input file by yourself, you can create a `filename.txt` file, then save it as `filename.inp`, and remember to change the file type to be `All files`.

**VS Code** is recommended for Windows users, because it enables Linux-like approach to create files.

## Structure of input file

The common structure for Orca input file is as follows:

```
! Keywords
# comments(You can write anything here)
%input blocks
*cordinates
*
```

For more detailed information, please refer to **Orca manual** or [this useful web page](https://sites.google.com/site/orcainputlibrary/home?authuser=0).
And there is some input files I saved as examples, which can be found at the [Examples](#example_jump) part.

### Keywords

#### Basic settings

The keyword lines start with a `!`, which define the job type and the methods we use, for example:

```
! opt HF 6-31G
# Job type: geometry optimization
# Method: Hatree-Fock
# Basis set: 6-31G
```

or

```
! M062X def2-TZVP
# Job type: single point calculation
# Method: DFT 
# Exchange-correlation Functional: M062X
# Basis set: def2-TZVP
```

>NOTE:<br/>
&emsp;1. You can write as many lines of keywords as you want.<br/>
&emsp;2. If no job type is defined, job type will be `single point calculation`.<br/>
&emsp;3. For DFT, you just need to define the functional, which means that `!B3LYP` and `!DFT B3LYP` are the same.

#### Restart job

`!moread` enables you to read the wavefunction file `*.gbw` from an interrupped job. job. After `!moread`, a `%moinp` block is necessary, eg:

```
!moread
%moinp "lastwork.gbw"
```

>NOTE:
&emsp;The name of `*.gbw` file **must** be different from the file name of current job.

#### Run parallel jobs

There are two ways to set up parallel jobs:

```
! PAL4
```

```
%pal
    nprocs 4
end
```

Both of them means using 4 parallel processes.
>NOTE:
&emsp;Orca should be called with full path for parallel jobs.

### Input blocks

Input blocks are for detailed settings of the calculation, here I only list two frequently used input blocks.
For more details, please refer to the Orca manual.

#### TDDFT settings

```
%tddft # Settings for TDDFT calculation
    nroots 5 # How many excited states
    dosoc true # Calculate SOC
    tda false # Set Tamm-Dancoff approximation
end #don't forget end
```

If you want to obtain the structures of excited states:

```
%tddft
    IRoot 1 #Here means the first excited state
    IRootMult Singlet # (or Triplet) setting S or T
    tda false
end
```

#### Solvent settings

First, a keyword line is needed:

```
!CPCM(water)
```

And an input block for detailed settings:

```
%cpcm
    smd true
    SMDsolvent "water"
end
```

### Coordinates input

Coordinates can be directly input as:

```
*coordinate_type charge multiplicity
    atom_type coordinates
    atom_type coordinates
*
```

For example:

```
*xyz 0 1
O   0.305   0.240   0.000
H   0.305   0.702   0.000
H   0.610   0.463   0.000
*
```

You can also input coordinates from file:

```
*xyzfile charge multiplicity filename.xyz
# to input from orca xyz file.
```

or

```
*gzmtfile charge multiplicity filename.gzmt
# to input from Gaussian Z-Matrices files.
```

>NOTE:<br/>
&emsp;1. After the file name, there **MUST** be a new line to prevent error.<br/>
&emsp;2. Filename should NOT be the same as input file name.

## Settings for B2PLYP functional

In B2PLYP functional, a given density functional(Becke88) is mixed with HF-exchange in a fraction of $c_x$. The correlation energy of DFT is also mixed with MP2 correlation energy in a fraction of $c_c$. The total exchange correlation energy can be expressed as:

$$\begin{equation}
E_\text{XC}=c_\text{X}E_\text{X,HF}+(1-c_\text{X})E_\text{X,DFT}+c_\text{C}E_\text{C,MP2}+(1-c_\text{C})E_\text{C,DFT}
\end{equation}$$

This can be defined in Orca as:

```
%method
    ScalHFX = cx
    ScalDFX = 1-cx
    ScalGGAC = 1-cc
    ScalLDAC = 1-cc
    ScalMP2C = cc
end
```

In order to do B2PLYP calculation by Orca, in addition to normal basis-set, auxiliary basis-set for correlation calculations is neccesary. For example:

```
! B2PLYP
! def2-TZVP def2-TZVP/c #define both the basis-set and the auxiliary basis-set.
```

For the auxiliary basis-sets available in Orca, please refer to the official manual of Orca.

# How to run Orca

The command to run Orca is simple:

```
<path_of_orca>/orca filename.inp > filename.out
```

And you can also add one line in your `.bashrc`:

```
alias orca=<path_of_orca>/orca
```

Then you can run orca with:

```
orca filename.inp > filename.out
```

>NOTE:
&emsp;Orca **MUST** be called with full path for parallel jobs.

# Output analysis

You can find all the output in the `.out` file.

## Final energy

For the final energy, search `FINAL SINGLE POINT ENERGY` in the `.out` file.

## HOMO and LUMO

### Orbital energy

Search `ORBITAL ENERGIES` in the `.out` file. The second column(`OCC`) means the occupation number of the orbital, and the last column represents the orbital energy with the unit of `eV` For example:

```
108 2.0000  -0.290681   -7.9098
109 2.0000  -0.243684   -6.6310
110 2.0000  -0.241963   -6.5842
111 0.0000  -0.069260   -1.8847
112 0.0000  -0.042617   -1.1597
113 0.0000  0.009858    0.2682
```

Here, orbital 110 is the HOMO, and orbital 111 is the LUMO.

### Plot the orbital

Please use the command `orca_plot gbw i` to plot the orbitals. Choose output file type to be `Gaussian cube` to visualize it in `Gaussview`.

## SOC Constant

Search for `CALCULATED SOCME BETWEEN TRIPLETS AND SINGLETS` in the `.out` file, then you can find the x,y,z components of SOC constant.

# <span id="example_jump">Examples</span>

## Geometry optimization

This is an example for geometry optimization.

```
!B3LYP 6-31g(d,p) opt tightscf
# Functional and basis set. opt means the job type is opt. Default job type is single point calculation.

%pal  # How many cores used
    nprocs 36
end

!CPCM(water)  #solvent settings
%cpcm
    smd true
    SMDsolvent "water"
end

# Sinplest way to input cordinates.
*xyz 0 1    #cordinates_type charge spin
O 0 0 0
*
# Remember the '*' at the end!!!!!
```

## SOC calculation

This is an example for calculating SOC matrix.

```
!M062X 6-31g(d,p) tightscf  # I think 'tightscf' is the default setting.

%tddft  # Settings for TDDFT calculation
nroots 5    # How many excited states
dosoc true  # Calculate SOC
tda false   # Just close it, goes wrong easily.
end     #don't forget end

%pal
    nprocs 36   # How many cores for parallel running
end

!CPCM(water)    # Solvent settings
%cpcm
    smd true
    SMDsolvent "water"
end

#This is another way to input cordinates, remember to have a new line at the end.
#This file should not be the same name as input file.
*xyzfile 0 1 opt.xyz


*xyz 0 1
O 0 0 0
*
```

## Bash script

This is the example of bash script to submit Orca calculation jobs for the cluster of UFS Lab.

```
#!/bin/bash


#$ -pe mpi_36 36
#$ -N Orca_yourname
#$ -S /bin/bash
#$ -q all.q@node02
#$ -V
#$ -cwd


echo "Got $NSLOTS slots."

module load openmpi-4.1.1

/opt/orca/orca_5_0_3/orca yourjob.inp>yourjob.out
```
